<section data-ng-controller="LoopsController" data-ng-init="findOne()">
    <div class="loopHeader">
        <label class="loopName">{{loop.name}}</label>

        <div class="loopControls">
            <button class="btn menuBtn" data-ng-click="">Save</button>
            <button class="btn menuBtn" data-ng-click="">Revert</button>

            <button class="btn menuBtn" data-ng-click="remove();"><span class="glyphicon glyphicon-trash"></span>
            </button>
            <button class="btn menuBtn" data-ng-click="">Settings </button>
        </div>
    </div>
</section>
<section data-ng-controller="PlaybackController">
    <div class = "sequencer">


        <div class="sequencerMainControls">
            <button class="btn btn-sm glyphicon" ng-click="play()" ng-model="playing">
                <span ng-class="{'glyphicon-play':!playing,'glyphicon-pause':playing}"></span>
            </button>

            <button class="btn btn-sm glyphicon" ng-click="stop()"><span class="glyphicon-stop"></span> </button>

            <button class="btn btn-sm " ng-click="clear()">Clear</button>

            <label style="width: 30px;"></label>

            <div class="btn-group">
                <button class="btn btn-sm glyphicon" ng-click="beats_per_bar=beats_per_bar-1"><span class="glyphicon-minus"></span> </button>
                <button class="btn btn-sm glyphicon" disabled>{{beats_per_bar}} beats per bar</button>
                <button class="btn btn-sm glyphicon" ng-click="beats_per_bar=beats_per_bar+1"><span class="glyphicon-plus"></span> </button>
            </div>
            <div class="btn-group">
                <button class="btn btn-sm glyphicon" ng-click="num_bars=num_bars-1"><span class="glyphicon-minus"></span> </button>
                <button class="btn btn-sm glyphicon" disabled>{{num_bars}} bars</button>
                <button class="btn btn-sm glyphicon" ng-click="num_bars=num_bars+1"><span class="glyphicon-plus"></span> </button>
            </div>

            <div class="btn-group bpm-ctrl">
                <button class="btn btn-sm glyphicon" ng-click="bpm=bpm/2"><span>/2</span></button>
                <button class="btn btn-sm glyphicon" ng-click="bpm=bpm-5"><span class="glyphicon-minus"></span> </button>
                <button class="btn btn-sm glyphicon" disabled>{{bpm}} BPM</button>
                <button class="btn btn-sm glyphicon" ng-click="bpm=bpm+5"><span class="glyphicon-plus"></span> </button>
                <button class="btn btn-sm glyphicon" ng-click="bpm=bpm*2"><span>*2</span> </button>
            </div>
        </div>

        <table class="sequencerTable">
            <tr>
                <td></td>

                <td/>
                <td ng-repeat="j in []|range:1:total_beats()" class = "timeBtn td-instrument-time" ng-class="{atTime:at_time(j), notAtTime:!at_time(j)}"/>

                <td/>
            </tr>
            <tr ng-repeat="i in instruments">
                <td>
                    <div class="btn-group instrument-select" dropdown>
                        <button type="button" class="btn btn-primary instrumentDropdown" ng-click="playInstrument(i)">{{i.sample.name}}</button>
                        <button type="button" class="btn btn-primary dropdown-toggle instrumentToggle" dropdown-toggle>
                            <span class="caret"></span>
                            <span class="sr-only">Split button!</span>
                        </button>
                        <ul class="dropdown-menu" role="menu">
                            <li ng-repeat="sample in samples" ><a ng-click="changeSample(sample,i)">{{sample.name}}</a></li>
                        </ul>
                    </div>
                </td>

                <td/>

                <td ng-repeat="j in []|range:1:total_beats()" class="customBtn td-instrument-button defaultBtn1" ng-click="sample_click(j-1,i)" 
                ng-class="{inactiveBeat1:beat_group(j,1)&&!pressed(j-1,i), inactiveBeat2:beat_group(j,2)&&!pressed(j-1,i), 
                inactiveBeatPlaying:!pressed(j-1,i)&&playing&&time==(j-1),
                activeBeat:pressed(j-1,i),activeBeatPlaying:pressed(j-1,i)&&playing&&time==(j-1)}"/>


                <td>
                    <button class="btn btn-sm" ng-click="removeInstrument(i)"><span class="glyphicon glyphicon-remove"></span></button>
                </td>
            </tr>
            <tr >
                <td>
                    <button class=" instrument-select btn btn-primary " ng-click="addInstrument()" style="margin-top:20px"><span class="glyphicon glyphicon-plus"></span> Add Instrument</button>
                </td>
                <td/>
            </tr>
        </table>

        <!-- <pre class="prettyprint">{{getInstrumentsPretty()}}</pre> -->
        <div>
        </section>